<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Rock Paper Scissors</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Press Start 2P', cursive;
            background-color: #282c34;
        }
        #ui {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1;
            color: white;
        }
        #result {
            margin-top: 20px;
            font-size: 1.2em;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
</head>
<body>

<div id="ui">
    <h1>Rock Paper Scissors 3D</h1>
    <input type="text" id="playerName" placeholder="Enter your name" style="padding: 10px; font-size: 1em;">
    <button id="startGame">Start Game</button>
    <div id="result"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.rawgit.com/mrdoob/three.js/master/examples/js/controls/OrbitControls.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>
<script>
    let scene, camera, renderer, controls;
    let playerName = '';
    let cardMeshes = [];
    const cardValues = ['‚úä', 'üñêÔ∏è', '‚úåÔ∏è'];
    const cardNames = ['rock', 'paper', 'scissors'];

    function init() {
        // –°—Ü–µ–Ω–∞
        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        renderer = new THREE.WebGLRenderer({ alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞–º–µ—Ä—ã
        controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;

        // –û—Å–≤–µ—â–µ–Ω–∏–µ
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        const pointLight = new THREE.PointLight(0xffffff, 1);
        pointLight.position.set(10, 10, 10);
        scene.add(pointLight);

        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫
        createCards();

        // –ö–∞–º–µ—Ä–∞
        camera.position.z = 5;

        // –°–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
        window.addEventListener('resize', onWindowResize, false);

        animate();
    }

    function createCards() {
        const geometry = new THREE.PlaneGeometry(1, 1.5);
        const material = new THREE.MeshBasicMaterial({ side: THREE.DoubleSide, transparent: true });

        cardValues.forEach((value, index) => {
            const cardMaterial = material.clone();
            cardMaterial.map = createCardTexture(value);
            const cardMesh = new THREE.Mesh(geometry, cardMaterial);
            cardMesh.position.set(-2 + index * 1.5, 0, 0);
            scene.add(cardMesh);
            cardMeshes.push(cardMesh);
            cardMesh.userData = { value: cardNames[index] }; // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É
            cardMesh.callback = function() {
                throwCard(cardNames[index]);
            };
        });
    }

    function createCardTexture(value) {
        const canvas = document.createElement('canvas');
        canvas.width = 256;
        canvas.height = 384;
        const context = canvas.getContext('2d');

        context.fillStyle = '#fff';
        context.fillRect(0, 0, canvas.width, canvas.height);
        context.font = '100px Arial';
        context.fillText(value, canvas.width / 2 - 50, canvas.height / 2 + 30);

        return new THREE.Texture(canvas);
    }

    function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    }

    function animate() {
        requestAnimationFrame(animate);
        controls.update();
        TWEEN.update(); // –û–±–Ω–æ–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏
        renderer.render(scene, camera);
    }

    document.getElementById('startGame').addEventListener('click', () => {
        playerName = document.getElementById('playerName').value.trim(); // –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤
        if (playerName) {
            document.getElementById('ui').style.display = 'none';
            cardMeshes.forEach(card => {
                card.callback = function() {
                    throwCard(card.userData.value);
                };
            });
        } else {
            alert('Please enter your name!');
        }
    });

    function throwCard(cardValue) {
        const thrownCard = new THREE.Mesh(
            new THREE.PlaneGeometry(1, 1.5),
            new THREE.MeshBasicMaterial({ map: createCardTexture(cardValue === 'rock' ? '‚úä' : cardValue === 'paper' ? 'üñêÔ∏è' : '‚úåÔ∏è'), side: THREE.DoubleSide })
        );
        thrownCard.position.set(0, 3, -3);
        scene.add(thrownCard);

        // –ê–Ω–∏–º–∞—Ü–∏—è –±—Ä–æ—Å–∫–∞
        const targetPosition = new THREE.Vector3(0, 0, -3);
        thrownCard.position.y = 3;

        const tween = new TWEEN.Tween(thrownCard.position)
            .to(targetPosition, 1000)
            .easing(TWEEN.Easing.Cubic.Out)
            .onComplete(() => {
                determineWinner(cardValue);
                scene.remove(thrownCard);
            })
            .start();
    }

    function determineWinner(playerChoice) {
        const botChoice = cardNames[Math.floor(Math.random() * cardNames.length)];
        const botCardMesh = new THREE.Mesh(
            new THREE.PlaneGeometry(1, 1.5),
            new THREE.MeshBasicMaterial({ map: createCardTexture(botChoice === 'rock' ? '‚úä' : botChoice === 'paper' ? 'üñêÔ∏è' : '‚úåÔ∏è'), side: THREE.DoubleSide })
        );
        botCardMesh.position.set(1, 0, -3);
        scene.add(botCardMesh);

        const result = getResult(playerChoice, botChoice);
        document.getElementById('result').innerText = `${playerName}, you chose ${playerChoice}, bot chose ${botChoice}. Result: ${result}`;
    }

    function getResult(playerChoice, botChoice) {
        if (playerChoice === botChoice) return 'It\'s a tie!';
        if ((playerChoice === 'rock' && botChoice === 'scissors') || 
            (playerChoice === 'scissors' && botChoice === 'paper') || 
            (playerChoice === 'paper' && botChoice === 'rock')) {
            return 'You win!';
        }
        return 'You lose!';
    }

    init();
</script>
</body>
</html>
